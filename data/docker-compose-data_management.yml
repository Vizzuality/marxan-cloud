version: "3.8"
services:
  marxan-seed-data:
    build:
        context: ./data_download
        dockerfile: Dockerfile
    volumes:
    - './data/seed/gadm_3.6/:/gadm_3.6/data/'
    - './data/seed/wdpa/:/wdpa/data/'
    - './data/seed/iucn/:/iucn/data/'
    - './data/seed/world_terrestrial_ecosystems/:/world_terrestrial_ecosystems/data/'
    user: "$UID:$GID"
    command: make
    environment:
        - POSTGRES_API_SERVICE_PORT=3432
        - POSTGRES_GEO_SERVICE_PORT=3433
        - GEO_POSTGRES_USER=marxan-geo-api
        - GEO_POSTGRES_PASSWORD=marxan-geo-api
        - GEO_POSTGRES_DB=marxan-geo-api
        - API_POSTGRES_USER=marxan-api
        - API_POSTGRES_PASSWORD=marxan-api
        - API_POSTGRES_DB=marxan-api

  marxan-restore-data:
    build:
        context: ./data_restore
        dockerfile: Dockerfile
    user: "$UID:$GID"
    command: make
    env_file:
        - '../.env'
networks:
    default:
      external:
        name: marxan-cloud-network
