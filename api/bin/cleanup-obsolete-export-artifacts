#!/bin/sh

cloning_storage_path="/opt/marxan-project-cloning"
workspace="$(mktemp -d)"
valid_export_ids_file="$workspace/valid-uuids.list"

tee "$valid_export_ids_file" 1>/dev/null

ls $cloning_storage_path | sort > "$workspace/all-uuids.list"

cd "$cloning_storage_path"
comm -23 "$workspace/all-uuids.list" "$workspace/valid-uuids.list" | tee "$workspace/dangling-uuids.list" | xargs rm -rf

rm -rf $workspace
